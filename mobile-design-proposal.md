# TIB OS 微信小程序移动端设计方案

## 📱 核心理念

将复杂的 AI 投资系统转化为**零门槛的对话式体验**，让没有 AI 使用经验的用户也能轻松上手。

## 🎯 用户场景与解决方案

### 场景 1：新手用户首次使用

**问题：** 不懂什么是 Prompt、不知道该填什么

**解决方案：**
1. 引导式对话而非表单
2. 每步只问一个问题，配有示例
3. 可以选择"自动填充示例"跳过

**交互流程：**
```
用户点击"开始使用"
↓
AI助手（虚拟角色）："你好！我是你的投资助手。请告诉我你想做什么？"
↓
用户选项：
  📊 财报刚发布
  📈 股价突然大涨/大跌
  🔍 发现新股票想了解
  💰 想买/卖股票
  📝 日常复盘
↓
根据选择，自动进入对应流程
```

### 场景 2：日常高频使用

**问题：** 不想重复输入相同信息

**解决方案：**
1. 智能记忆持仓信息
2. 一键复制上次输入
3. 支持模板收藏

## 🏗️ 技术架构

### 方案 A：微信小程序 + 豆包 API（推荐）

```
┌─────────────────┐
│  微信小程序前端  │
│  - UI/UX        │
│  - 本地存储      │
└────────┬────────┘
         │
         │ HTTPS API
         ↓
┌─────────────────┐
│  Node.js 后端   │
│  - Prompt 管理  │
│  - 用户数据     │
│  - API 网关     │
└────────┬────────┘
         │
         ↓
┌─────────────────┐
│  豆包/智谱 API  │
│  - AI 推理      │
│  - 流式响应     │
└─────────────────┘
```

### 方案 B：纯前端 + 一键跳转

```
┌─────────────────┐
│  微信小程序      │
│  - 生成 Prompt  │
│  - 剪贴板操作   │
└────────┬────────┘
         │
         ↓
┌─────────────────┐
│  微信内置浏览器  │
│  打开豆包/智谱   │
│  自动粘贴发送   │
└─────────────────┘
```

## 📐 界面设计

### 主页布局（Tab 1：智能助手）

```
┌─────────────────────────┐
│  TIB 投资助手    设置  │
├─────────────────────────┤
│                         │
│    👋 今天想做什么？     │
│                         │
│  ┌───────────────────┐ │
│  │ 📊 财报刚出来     │ │
│  │ 快速解读财报影响  │ │
│  └───────────────────┘ │
│                         │
│  ┌───────────────────┐ │
│  │ 📈 股价异动分析   │ │
│  │ 涨跌幅超5%时使用  │ │
│  └───────────────────┘ │
│                         │
│  ┌───────────────────┐ │
│  │ 🔍 新股调研       │ │
│  │ 深度了解一只股票  │ │
│  └───────────────────┘ │
│                         │
│  ┌───────────────────┐ │
│  │ 💰 买卖决策       │ │
│  │ 防止FOMO和恐慌    │ │
│  └───────────────────┘ │
│                         │
└─────────────────────────┘
```

### 对话式输入界面

```
┌─────────────────────────┐
│  ← 返回  财报解读  下一步│
├─────────────────────────┤
│                         │
│  请输入股票代码         │
│  ┌───────────────────┐ │
│  │ 输入代码...       │ │
│  └───────────────────┘ │
│                         │
│  💡 例如：AAPL、TSLA   │
│  📌 常用：NVDA | BABA  │
│                         │
│  ────────────────────── │
│                         │
│  财报内容               │
│  ┌───────────────────┐ │
│  │ 粘贴或输入财报内容 │ │
│  │                   │ │
│  │ 📷 拍照识别       │ │
│  │ 🎤 语音输入       │ │
│  └───────────────────┘ │
│                         │
│  ────────────────────── │
│                         │
│  当前持仓情况（可选）    │
│  ┌───────────────────┐ │
│  │ 持有仓位...       │ │
│  └───────────────────┘ │
│                         │
└─────────────────────────┘
         ┌─────┐
         │ 下一步│
         └─────┘
```

### 结果展示界面

```
┌─────────────────────────┐
│  ← 返回  分析结果  分享 │
├─────────────────────────┤
│                         │
│  📊 NVDA Q3 财报解读    │
│                         │
│  ━━━━━━━━━━━━━━━━━━    │
│  核心结论               │
│  ━━━━━━━━━━━━━━━━━━    │
│  ✅ 利好因素：          │
│  • 数据中心收入超预期   │
│  • 毛利率提升至 78%    │
│                         │
│  ⚠️  关注风险：         │
│  • 中国市场收入下降     │
│  • 估值处于高位区间     │
│                         │
│  🎯 操作建议：           │
│  SOP 1（长持）：继续持有 │
│  SOP 2（短线）：突破后回调买│
│                         │
│  ────────────────────── │
│                         │
│  💾 保存到知识库         │
│  📋 复制内容            │
│  🔄 重新分析            │
│                         │
└─────────────────────────┘
```

### 知识库页面（Tab 2）

```
┌─────────────────────────┐
│  我的投资库    搜索  +   │
├─────────────────────────┤
│                         │
│  🔖 股票                │
│  ┌───────────────────┐ │
│  │ NVDA  🟢 长持      │ │
│  │ 最后更新: 今天     │ │
│  └───────────────────┘ │
│  ┌───────────────────┐ │
│  │ TSLA  🟡 观察      │ │
│  │ 最后更新: 3天前   │ │
│  └───────────────────┘ │
│                         │
│  ────────────────────── │
│  📝 分析记录            │
│  ┌───────────────────┐ │
│  │ NVDA Q3 财报解读  │ │
│  │ 2024-01-30        │ │
│  └───────────────────┘ │
│  ┌───────────────────┐ │
│  │ TSLA 价格异动    │ │
│  │ 2024-01-28        │ │
│  └───────────────────┘ │
│                         │
└─────────────────────────┘
```

## 🎯 核心功能实现

### 1. 智能表单

将 `prompts.js` 中的复杂 Prompt 转化为对话式问题：

```javascript
// 原 Prompt 需要：ticker, event, context, sentiment
// 转化为对话：
{
  "step1": {
    "question": "哪只股票？",
    "type": "text",
    "placeholder": "输入代码，如 NVDA",
    "suggestions": ["NVDA", "AAPL", "TSLA"]
  },
  "step2": {
    "question": "发生了什么事？",
    "type": "textarea",
    "placeholder": "描述事件或粘贴新闻",
    "features": ["拍照识别", "语音输入"]
  },
  "step3": {
    "question": "目前市场情绪如何？",
    "type": "choice",
    "options": ["看涨", "看跌", "震荡", "不确定"]
  },
  "step4": {
    "question": "有持仓吗？",
    "type": "optional",
    "placeholder": "持有数量和成本（可选）"
  }
}
```

### 2. Prompt 生成器

```javascript
async function generatePrompt(scenarioId, userInputs) {
  const template = SCENARIO_TEMPLATES[scenarioId];
  let prompt = template.basePrompt;

  // 智能填充
  for (const [key, value] of Object.entries(userInputs)) {
    const patterns = INPUT_PATTERNS[key];
    prompt = prompt.replace(patterns, `[${value}]`);
  }

  // 添加上下文增强
  if (userInputs.knowledgeBase) {
    prompt += `\n\n# 我的持仓知识库\n${userInputs.knowledgeBase}`;
  }

  return prompt;
}
```

### 3. AI 集成

```javascript
// 方案 A: 直接调用 API
async function analyzeWithAI(prompt) {
  const response = await fetch('https://api.doubao.com/v1/chat', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${API_KEY}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      model: 'doubao-pro',
      messages: [{role: 'user', content: prompt}]
    })
  });

  return response.json();
}

// 方案 B: 跳转到豆包
function jumpToDoubao(prompt) {
  wx.setClipboardData({
    data: prompt,
    success: () => {
      wx.navigateToMiniProgram({
        appId: '...', // 豆包小程序ID
        success: () => {
          setTimeout(() => {
            wx.showToast({title: '已粘贴，请发送'});
          }, 1000);
        }
      });
    }
  });
}
```

## 🚀 开发路线图

### Phase 1: MVP（4周）
- [ ] 基础 UI 框架
- [ ] 3 个核心场景（财报、异动、新股）
- [ ] 对话式输入
- [ ] 生成 Prompt + 跳转豆包

### Phase 2: 核心功能（6周）
- [ ] 15 个 Prompt 全部场景化
- [ ] 本地知识库存储
- [ ] 历史记录
- [ ] 一键复制和分享

### Phase 3: 高级功能（8周）
- [ ] 豆包 API 深度集成
- [ ] 流式显示结果
- [ ] 智能推荐
- [ ] 数据可视化

### Phase 4: 优化（持续）
- [ ] 语音输入优化
- [ ] OCR 拍照识别
- [ ] 用户行为分析
- [ ] A/B 测试

## 💡 降低使用门槛的设计

### 1. 新手引导
- 首次使用 3 步引导
- 每个功能 30 秒视频演示
- "示例数据"一键体验

### 2. 语言本地化
- 不用 "Ticker"，用"股票代码"
- 不用 "PVE/PVP"，用"长期持有/短期交易"
- 解释术语时使用生活化比喻

### 3. 智能默认值
- 自动读取用户常用股票
- 记住上次的选择
- 智能推荐下一个操作

### 4. 错误处理
- 输入验证和友好提示
- 提供修正建议
- 支持撤销和重新编辑

## 📊 成功指标

- **新用户 7 天留存率** > 40%
- **完成一次分析的耗时** < 3 分钟
- **用户满意度评分** > 4.5/5
- **知识库使用率** > 60%

## 🔐 安全与隐私

- 用户数据加密存储
- 不收集敏感财务信息
- 可选匿名模式
- 知识库支持导出和删除

---

**下一步：** 建议先做原型设计，验证交互流程，再开始编码。
